export class Parser{constructor(e={}){this.tree=e.tree||[],this.result="",this.noData=e.noData||!1}parse(e=!1,t=!1){let r=this.tree[0];return e&&(r=e),0!=r.childs.length&&(t&&(globalThis._this=t),r.childs.forEach(e=>{if("text"!=e.type)if("variable"!=e.type){if("loop"==e.type){let r=e.childs.find(e=>"params"==e.type);if(!r)return void(this.result+=this.noData||"!Can't find params!");let s=Function('"use strict";return ((_this) => {return '+r.value[0]+"})")()(t),i=r.value[1];if("object"==typeof s){return Object.keys(s).forEach(r=>(globalThis._loopIndex=r,globalThis[i]=s[r],this.parse(e,t))),delete globalThis[i],void delete globalThis._loopIndex}return Array.isArray(s)?(s.forEach((r,s)=>(globalThis._loopIndex=s,globalThis[i]=r,this.parse(e,t))),delete globalThis[i],void delete globalThis._loopIndex):void(this.result+=this.noData||"!Wrong type of array!")}if("if"!=e.type);else{let r=e.childs.find(e=>"params"==e.type);if(!r)return void(this.result+=this.noData||"!Can't find params!");if(Function('"use strict";return ((_this) => {return '+r.value[0]+"})")()(t))return this.parse(e,t);{let r=e.childs.find(e=>"else"==e.type);if(r)return this.parse(r,t)}}}else this.result+=Function('"use strict";return ((_this) => {return '+e.value+"})")()(t);else this.result+=e.value}),delete globalThis._this,this.result)}clear(){return this.result="",this}setTree(e){return this.tree=e,this}getTree(){return this.tree}getResult(){return this.result}}